{
  "$schema": "https://railway.com/railway.schema.json",
  "build": {
    "builder": "RAILPACK"
  },
  "deploy": {
    "runtime": "V2",
    "numReplicas": 1,
    "sleepApplication": false,
    "useLegacyStacker": false,
    "multiRegionConfig": {
      "europe-west4-drams3a": {
        "numReplicas": 1
      }
    },
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  },
  "services": [
    {
      "name": "telegram-bot-mobile",
      "source": {
        "type": "git"
      },
      "build": {
        "buildCommand": "npm install"
      },
      "deploy": {
        "startCommand": "node telegram-bot-mobile-setup.js",
        "runtime": "V2"
      },
      "env": {
        "NODE_ENV": "production"
      }
    },
    {
      "name": "mcp-autopilot-server",
      "source": {
        "type": "git"
      },
      "build": {
        "buildCommand": "cd mcp-server && npm install"
      },
      "deploy": {
        "startCommand": "cd mcp-server && npm start",
        "runtime": "V2"
      },
      "cron": {
        "schedule": "0 7 * * *",
        "command": "node mcp-server/cron-jobs.js"
      },
      "env": {
        "NODE_ENV": "production"
      }
    },
    {
      "name": "nextjs-dashboard",
      "source": {
        "type": "git"
      },
      "build": {
        "buildCommand": "npm install && npm run build"
      },
      "deploy": {
        "startCommand": "npm start",
        "runtime": "V2"
      },
      "healthcheckPath": "/health",
      "healthcheckTimeout": 100,
      "env": {
        "NODE_ENV": "production",
        "PORT": "3000"
      }
    }
  ],
  "environments": {
    "production": {
      "env": {
        "REQUIRED": [
          "NEXT_PUBLIC_SUPABASE_URL",
          "NEXT_PUBLIC_SUPABASE_ANON_KEY",
          "SUPABASE_SERVICE_KEY",
          "OPENAI_API_KEY",
          "TELEGRAM_BOT_TOKEN"
        ],
        "OPTIONAL": [
          "DEPLOYMENT_URL",
          "NODE_ENV",
          "PORT"
        ]
      }
    }
  }
}
